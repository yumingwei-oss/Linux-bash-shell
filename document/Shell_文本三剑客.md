
# Linux文本三剑客，awk grep sed

> 在Linux下一切皆文件，所以Linux下的操作就是对文件的操作。出于对文件更好的操作，awk grep sed应运而生。
> * grep 适合单纯的查找或匹配文本
> * sed  适合编辑匹配到的文本
> * awk  适合格式化文本，对文本进入复杂格式处理

## Sed

> Linux sed命令是利用script来处理文本文件
> sed是面向"行"处理，一次脚本是处理缓冲区中一行内容，处理完后把缓冲区内容输出到屏幕。（在这个过程中，sed命令并不会对文件本身进行任何更改

* 语法
	sed [选项][脚本命令]文件名		
	sed [-hnv][-e<script>][-f<script>][文本文件]
	* -e<script> 以选项中指定的脚本来处理文本文件 //常用
	* -f<scriptfile> 以选项中指定的脚本文件来处理文件
	* -E,-r 支持扩展正则表达式
	* -i 此选项会直接修改源文件，要慎用

*Sed脚本命令  --脚本命令在''之间
>脚本是sed命令的精髓，command部分可以分为两块知识：范围设定 和 动作处理

	1 范围设定，可以采用不同方式来表达
		* 指定行数：比如'3' '3,5'表示第三行和第三行到第五行
		* 模式匹配：正则匹配，比如'/^[^dD]/',匹配不以d,D开头行 正则表达式在//内

	2 动作处理，会提供丰富的动作供选择，如
		* d :删除行
		* p :打印行--常常与 -n 一起使用
		* a :在下面插入新行内容
		* i :在上面插入新行内容

		2.1 s 替换脚本命令
	
			格式：  [address]s/pattern/replacement/flags    // 其中address是范围设定，pattern是要替换的内容，replacement是替换的内容，flags功能

		flags标记的功能
			n 表示指定要替换的字符串出现第几次才进入替换
			g 对数据所有匹配到的内容进行替换，如果没有g，则只会在第一次匹配成功替换
			p 会打印替换命令中指定模式匹配的行
			w file 将缓冲区的内容写到指定文件
		2.2 d 删除行脚本命令
			
			格式 ： [address]d   如  sed '3d' file.txt//删除第三行 sed '/^[dD]/d'  //删除以d或D开头的行
					
		2.3 a\i 插入行脚本命令

			格式 : [address]a(或者i)\新行内容   如  sed '2a\hello world' 在第二行下面插入
			
			新行内容在\后面
		
		2.4 c 行替换脚本

			格式: [address]c\用于替换的新内容  //将指定行替换为指定内容-整行

		2.5 y 转换脚本命令--唯一可以处理单个字符的sed脚本命令

			格式 ： [address]y/inchars/outchars/   

			转换命令会将inchars和outchars的值进行一对一的映射，即inchars第一个字符会被outchars第一个字符替换

			如 : sed 'y/123/890/' file.txt

			     输出的结果中 1会变成8  2会变成9 3会变成0


## Awk  

> Linux中除了sed外，还胡一个功能更加强大的文本数据工具就是awk

* 语法:   awk [选项] '脚本命令' 文件名

	选项：-F 指定输入行的分隔符，默认为空格
	      -v 赋值一个用户定义变量
	      -f filescript 从脚本文件读取awk命令

	脚本命令：awk的强大之处在于脚本命令，它由两部分组成，分别为匹配规则和执行命令

		格式： '匹配规则{执行命令}'   //匹配规则在前，执行命令在后且在大括号包括内  注：整个脚本在''内，且执行命令在{}内

		如： awk '/^$/{printf "Blank line"}' file.txt    //功能是匹配文本中空白行后输出 Blank line

		
	1 基本用法

		awk -F/ '/[0-9]\{7\}/' file.txt   // 以指定分隔符/分隔文本每一行，并用指定匹配模式匹配

		aw -va '{printf $1+a,$1}' file.txt
		awk -va=1 -vb=2 'printf $1+a,$1+b' file.txt

		awk -f cal.awk file.tx    // cal.awk是awk脚本文件

		awk '{cmd1;cmd2;cmd3;}' file.txt  //如果需要执行多条命令，命令间用;隔开。

	2 脚本命令中支持的运算符及内建变量

		2.1运算符

		 	赋值 ： = += -= *= /=
			逻辑 : && ||
			正则与不正则： ~正则  ~！不正则
			连接 ： 空格
			等等……
	
		2.2内建变量

			$n ： 当前行分隔后第n个字段
			$0 :  完整的输入记录
			FILENAME : 文件名
			IGNORECASE : 如果为真，则忽略大小写匹配

		2.3两个重要关键词

			关于awk脚本命令，有两个重要关键词BEGIN&&END

			BEGIN{放在执行前的命令}
			END {放在处理完所有行后需要执行的命令}
			{cmd} 放每行需要执行的命令

			格式： awk 'BEGIN{CMD1} {CMD2} END{CMD3}' //BEGIN&&END并非是必须的

## Grep

